<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>上传单词 - LingoWise</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .upload-container {
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
        }
        .file-input {
            margin: 20px 0;
        }
        .word-list {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        .word-item {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .preview-table th, .preview-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .preview-table th {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="platform-header">
        <img src="logo.png" alt="LingoWise Logo" class="platform-logo" />
        <h1 class="platform-title">LingoWise</h1>
        <p class="platform-slogan">AI辅助英语学习平台</p>
    </div>
    <div class="upload-container">
        <h2>上传单词列表</h2>
        <div class="book-selection">
            <label for="bookSelect">教材：</label>
            <select id="bookSelect">
                <option value="">请选择教材</option>
                <option value="starter">Think Starter</option>
                <option value="think1">Think 1</option>
            </select>
        </div>
        <div class="unit-selection" style="margin:20px 0;">
            <label for="unitSelect">单元：</label>
            <select id="unitSelect">
                <option value="">请选择单元</option>
            </select>
        </div>
        <div class="file-input">
            <input type="file" id="wordFile" accept=".txt,.csv" />
            <p style="color: #666; font-size: 0.9em; margin-top: 5px;">
                支持的格式：TXT 或 CSV 文件<br>
                每行格式：单词,音标,中文释义<br>
                例如：apple,/ˈæp.əl/,苹果
            </p>
        </div>
        <div id="previewArea" style="display: none;">
            <h3>预览</h3>
            <table class="preview-table">
                <thead>
                    <tr>
                        <th>单词</th>
                        <th>音标</th>
                        <th>释义</th>
                    </tr>
                </thead>
                <tbody id="previewBody"></tbody>
            </table>
        </div>
        <button class="main-btn" onclick="uploadWords()" style="margin-top: 20px;">上传单词</button>
        <a href="index.html" class="home-btn" style="margin-top: 20px; display: block;">返回主页</a>
    </div>
    <div class="platform-footer">© 2024 Penny's English Studio · LingoWise</div>

    <script>
        // 动态生成单元选项
        document.getElementById('bookSelect').addEventListener('change', function() {
            const book = this.value;
            const unitSelect = document.getElementById('unitSelect');
            unitSelect.innerHTML = '<option value="">请选择单元</option>';
            if (book) {
                for (let i = 1; i <= 12; i++) {
                    const opt = document.createElement('option');
                    opt.value = `unit${i}`;
                    opt.textContent = `Unit ${i}`;
                    unitSelect.appendChild(opt);
                }
            }
        });

        // 文件预览
        document.getElementById('wordFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const lines = content.split('\n');
                const previewBody = document.getElementById('previewBody');
                previewBody.innerHTML = '';

                lines.forEach(line => {
                    if (line.trim()) {
                        const [word, phonetic, meaning] = line.split(',').map(item => item.trim());
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${word || ''}</td>
                            <td>${phonetic || ''}</td>
                            <td>${meaning || ''}</td>
                        `;
                        previewBody.appendChild(row);
                    }
                });

                document.getElementById('previewArea').style.display = 'block';
            };
            reader.readAsText(file);
        });

        // 上传单词
        function uploadWords() {
            const book = document.getElementById('bookSelect').value;
            const unit = document.getElementById('unitSelect').value;
            const file = document.getElementById('wordFile').files[0];

            if (!book || !unit) {
                alert('请选择教材和单元');
                return;
            }
            if (!file) {
                alert('请选择要上传的文件');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const words = content.split('\n')
                    .filter(line => line.trim())
                    .map(line => {
                        const [word, phonetic, meaning] = line.split(',').map(item => item.trim());
                        return { word, phonetic, meaning };
                    });

                // 保存到 localStorage
                const key = `${book}_${unit}_words`;
                localStorage.setItem(key, JSON.stringify(words));
                alert('单词上传成功！');
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>